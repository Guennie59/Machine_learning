---
title: "Analysis of Weight Lifting Exercises"
author: "Guennie59"
date: "December 28th, 2017"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(warn=-1)
	
```
## Synopsis


...............  

## Data Processing - Main steps 

The data are processed in the following steps

1. Data are downloaded from the links provided at course website
2. Data are being split up for cross validation

 

```{r}
library(ggplot2)
library(caret)
library(randomForest)

url_train <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
url_quiz  <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"	

	file_train <- "pml-training.csv"
	file_quiz <- "pml-testing.csv"

	if (!file.exists(file_train)) {
		download.file(url_train, file_train)
	}
	if (!file.exists(file_quiz)) {
		download.file(url_train, file_quiz)
	}
	
  pml_train_org <- read.csv(file_train)
  pml_quiz <- read.csv(file_quiz)
  ## colnames(pml_train_org)

```

The "training" data is being split into 3 parts: training (60%), test(20%) and validation(20%). 
The reason is that the original "testing" set with 20 records is far to small to allow cross validation with statistical significance and will be only used to answer the quiz. Given the number of samples and the number of variables in the data set, it is expected that quite a bit work on model selection is required. Hence independent "testing" and "validation" sets are being generated, as the "testing" data set will play a role in model selection and therefore is part of the training set in some way. "Testing" and "validation" and validation sets are selected to be of similar size.

```{r}  
  sum_bad_cols <- vector(length=160)  
  for (i in 1:160) {
    ## print(c(i,sum(is.na(pml_train_org[,i])),sum(pml_train_org[,i] == ""),sum(pml_train_org[,i] == "#DIV/0!")))
    sum_bad_cols[i] <- sum(sum(is.na(pml_train_org[,i])),sum(na.omit(pml_train_org[,i] == "")),
                           sum(na.omit(pml_train_org[,i] == "#DIV/0!")))  
  }
  col_ind <- sum_bad_cols == 0

  ## print(sum_bad_cols)
  ## print(col_ind)
  
  pml_train_org_clean <- pml_train_org[,col_ind]
  
  set.seed(1101959)
  in_train_org <- createDataPartition(y=pml_train_org_clean$classe, p=0.2,list=FALSE)
  pml_train <- pml_train_org_clean[in_train_org,]
  pml_val <- pml_train_org_clean[-in_train_org,]
  
  in_train <- createDataPartition(y=pml_train$classe, p=0.75,list=FALSE)
  pml_test <- pml_train[-in_train,]
  pml_train <- pml_train[in_train,]
  
  colnames(pml_train)
  ## pml_rf <- train(pml_train$classe ~ . ,method="rf",data=pml_train)
  
  ## pml_rf


  dim(pml_train)
  dim(pml_test)
  dim(pml_val)
  
  
```
        
## Conclusion


Acknowledgements: Special thanks to the authors of the following publication:
Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. 
Qualitative Activity Recognition of Weight Lifting Exercises. 
Proceedings of 4th Augmented Human (AH) International Conference in cooperation with ACM SIGCHI (Augmented Human'13) . Stuttgart, Germany: ACM SIGCHI, 2013. 

http://web.archive.org/web/20161217164008/http://groupware.les.inf.puc-rio.br:80/work.jsf?p1=11201